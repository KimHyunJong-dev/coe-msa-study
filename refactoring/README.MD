# 0장. 리팩토링이란

## 리팩토링이란 
### 리팩토링의 정의
```
외부에서 본 프로그램의 동작은 변하지 않고 프로그램 내부의 구조를 개선하는 것
- 리팩토링을 하더라도 외부에서 보이는 프로그램의 동작은 변함이 없다
- 프로그램의 내부 구조는 개선된다
```
ex) 디버깅, 기능 추가는 리팩토링이 아님

### 리팩토링과 유닛테스트
Q) 리팩토링을 하더라도 외부에서 보는 프로그램의 동작에는 변함이 없습니다. 
그럼 프로그램 동작이 정말 변화가 없다라는 것은 어떻게 확인할 수 있을까요?

A) 유닛테스트를 통해 아래의 과정을 거쳐 확인합니다. 

  0. 리팩토링 전 테스트 수행
  1. 리팩토링
  2. 리팩토링 후 테스트 수행

리팩토링은 테스트가 필수라고 생각하는 것이 좋습니다. 
만약 리팩토링하려고 생각하는 프로그램에 테스트가 없다면, 먼저 테스트를 만드는 것을 검토합시다.

### 리팩토링의 목적
- 버그를 찾아내기 쉽게 한다. 
- 기능을 추가하기 쉽게 한다.
- 리뷰하는 것이 쉬워진다. 

### 리팩토링의 한계
리팩토링은 언제라도 가능한 것은 아닙니다. 적용할 수 없는 경우도 있습니다.
- 프로그램이 아직 동작하지 않는 경우. 
- 설계와 코딩이 좋지 않아 버그투성이인, 사용할 수 없는 프로그램.
- 시간이 얼마 남지 않았을 경우 (납기 기간이 가까워 졌을 때)

## 리팩토링과 코드의 악취

### 코드의 악취(Bad Smells in Code)란
마틴파울러 22가지 Bad Smells 

- 이해하기 어렵다
- 수정하기 어렵다
- 확장하기 어렵다

```
- 겹쳐 있다! (Duplicated Code)
- 너무 길다! (Long Method)
- 너무 많다! (Large Class)
- 이름이 어울리지 않는다!
- 지나치게 공개했다
- 객체지향적이지 않다
  - switch문이나 if문을 사용해서 처리를 분기만 한다
  - instanceof를 사용해서 오브젝트가 속해있는 클래스를 찾기만 한다.
  - int만 너무 많이 사용하고, 전용 클래스를 만들지 않았다. 
```

## 리팩토링 카탈로그 
마틴 파울러의 Refactoring에서는 각 리팩토링의 목적이나 순서를 카탈로그화 하여 정리하고 있습니다.
http://www.refactoring.com

## 리팩토링의 에센스
리팩토링의 근원으로 꼭 마음 속에 새겨두어야 합니다. 

***Step by Step***

1. Step by Step : 한 번에 2개씩 수정하지 않는다
2. Step by Step : 후에 돌아오기 쉽게

   한 단계씩 진행하는 가장 큰 목적은 "마지막 스텝을 되돌리는 것"이 편해지기 때문입니다.
3. Step by Step : 단계마다 확인

   컴파일하기, 컴파일해서 테스트하기로 "스텝마다 확인"
4. Step by Step : 오래된 것을 새로운 것으로 바꿔가자

   한 번에 변경하지 말고 하나씩 하나씩 바꿔가는 것이 안전합니다. 
   "움직이는 상태를 보존한 채로 새로운 코드를 추가해서, 오래된 것이 모두 새롭게 되었을 때에 예전 것을 없애자"
