# 2장. ‘마이크로서비스 관련 아키텍처 스타일 및 사례’

### 서비스 지향 아키텍처 - SOA


### 12 factor app - heroku
단일 코드 베이스
- 각 어플리케이션은 하나의 코드 베이스를 갖는다
- 형상 관리 도구를 이용해 코드 관리
- 각 마이크로서비스는 각각의 코드 베이스를 독립적으로 갖는다

의존성 꾸러미(Bundling Dependencies)
- 모든 어플리케이션은 필요한 모느 의존성을 한의 꾸러미에 담는다
- 마이크로서비스는 필요한 모든 의존성과 Http 리스너 등과 같은 실행 가능한 모든 라이브러리를 묶어 최종 실행 꾸러미를 만든다

환경설정 외부화
- 모든 환경설정 파라미터를 코드와 분리해 외부화한다.
- 환경에 따라 달라지는 유일한 값은 환경설정 파라미터므로 배포 프로세스 자동화에 환경설정 외부화는 필수이다.

후방 지원 서비스 접근성 (Backing service)
- 모든 후방 지원 서비스는 URL을 통해 접근가능해야한다.
- 마이크로서비스는 메시징 시스템, API를 사용

빌드, 출시, 운영의 격리

무상태, 비공유 프로세스
- 프로세스는 상태가 없어야하고, 프로세스간 공유하는 것이 없는 것이 좋음 : 장애 대응성, 확장성을 위함
- 상태 저장 요구사항이 있는 경우 DB, 인메모리 캐시에서 처리

서비스를 포트에 바인딩하여 노출
- 어플리케이션은 자기 완비적, 독립 설치형이어야 함

확장을 위한 동시성
- 복제를 통해 프로세스가 확장될 수 있도록 설계 : x축 확장(scale-out)

폐기영향 최소화
- 어플리케이션 시동, 종료 시간 최소화
- 종료시 필요한 작업 완료 후 우아한 방식으로 종료되도록 처리
- 마이크로서비스에서는 최소한의 시동/종료 시간을 위해 객체, 데이터의 지연 로딩도 고려할 수 있음

개발과 운영의 짝 맞춤(Development and production parity)
- 환경은 동일하게
- 운영환경에서 발생한 장애를 동일하게 재연할 수 있어야함

로그 외부화
- 로그는 외부에 저장 : 클라우드에서는 병목현상 발생가능성 때문에 로컬 I/O를 최대한 피해야함
- 중앙 집중형 로깅 프레임워크 사용 : Splunk, Greylog, Logstash, Logplex, Loggly

관리자 프로세스 패키징
- 관리자용 태스크는 어플리케이션 서비스가 실행되는 동일한 환경해서 실행되어야 함
- 관리자용 태스크 : 운영 DB 확인, 어플리케이션 기능 점검용 일회성 스크립트


### 서버리스 컴퓨팅
마이크로서비스와 유사
- 한번에 하나의 임무만 수행
- 외부와 격리
- 이벤트 기반 또는 HTTP 기반의 API를 통해서만 외부와 통신
- 마이크로서비스 처럼 서버리스 함수도 작은 공간만 차지

벤더 종속성이 강한 특성

### 람다 아키텍처
빅데이터, 인지 컴퓨팅, 사물 인터넷 분야에서 사용되는 아키텍처
- 배치 계층 : 데이터를 처리, HDFS에 저장, 마이크로서비스로 구현하여 서빙 계층으로 데이터 전달
- 스피드 계층 : 스트림 실시간 처리, 리액티브 마이크로서비스 적용
- 서빙 계층 : 마이크로서비스를 통해 API로 데이터 외부에 제공


### DevOps, Cloud, Microservices
조직의 목표는 효율적인 방식으로 신속한 변경 및 배포와 높은 품질을 달성하는 것

DevOps, Cloud, Microservices 모두 그러한 목표를 달성하는 데 도움을 줌

프로세스로서 DevOps
- DevOps는 마이크로서비스 변경 및 배포를 위한 프로세스와 실천 방식 제공

마이크로서비스를 위한 셀프 서비스 인프라스트럭처로서의 클라우드
- 클라우드는 전달 신속성과 비용절감이라는 두 가지 목표 달성에 도움


### 리액티브 마이크로서비스
리액티브 프로그래밍 패러다임은 확장성 있고 장애를 견딜 수 있는 어플리케이션을 만드는 데 효과적

마이크로서비스 아키텍처에 리액티브 프로그래밍 원칙을 더해 빠른 속도로 많은 양의 데이터를 처리할 수 있는 확장성 있는 애플리케이션 개발 가능

리액티브 프로그래밍 4 pillars

- 회복성 (Resilient)
- 응답성 (Responsive)
- 메시지 기반 (Message Driven)
- 탄력성 (Elastic)
